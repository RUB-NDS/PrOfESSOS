<?xml version="1.0" encoding="UTF-8"?>
<TestPlan xmlns="http://nds.rub.de/oidc/test-model"
		  Name="OP-Test-Plan">

	<SuiteParameters>
		<Parameter Key="grant_not_needed">false</Parameter>
	</SuiteParameters>

	<LearningStep Name="LearningStep">
		<BrowserSimulator>
			<ImplementationClass>de.rub.nds.oidc.browser.OPLearningBrowser</ImplementationClass>
		</BrowserSimulator>
		<RPConfig-1>
			<ImplementationClass>de.rub.nds.oidc.server.rp.DefaultRP</ImplementationClass>
		</RPConfig-1>
		<RPConfig-2>
			<ImplementationClass>de.rub.nds.oidc.server.rp.DefaultRP</ImplementationClass>
		</RPConfig-2>
	</LearningStep>

	<TestStep Name="None">
		<Description>Not Implemented</Description>
		<TestParameters>
			<Parameter Key="is_single_rp_test">true</Parameter>
		</TestParameters>
		<BrowserSimulator>
			<ImplementationClass>de.rub.nds.oidc.browser.DefaultOPTestBrowser</ImplementationClass>
		</BrowserSimulator>

		<RPConfig-1>
			<ImplementationClass>de.rub.nds.oidc.server.op.DefaultRP</ImplementationClass>
			<Parameter Key="bar">baz</Parameter>
		</RPConfig-1>
		<RPConfig-2>
			<ImplementationClass>de.rub.nds.oidc.server.op.DefaultRP</ImplementationClass>
			<Parameter Key="bar">baz</Parameter>
		</RPConfig-2>
	</TestStep>
	<!--<TestStep Name="ID Spoofing 1">-->
		<!--<Description><![CDATA[-->
			<!--<h1>ID Spoofing Attack</h1>-->
			<!--In this test we use the Attacker OP and create an ID Token containing the identity (sub) of the victim,-->
			<!--which is controlled by another OP: Honest OP.-->

			<!--<h2>Prerequisites.</h2>-->
			<!--The target Client supports the implicit or the code flow. -->

			<!--<h2>Execution.</h2>-->
			<!--PrOfESSOS issues an invalid ID token containing the victim's identity in the "sub".-->

			<!--<h2>Result Evaluation.</h2>-->
			<!--The attack is successful if the Client accepts and ID Token AND logs the attacker into the victim's account.-->
			<!---->
			<!--<h2>Mitigation</h2>-->
			<!--The identity of an user is represented by the combination of "iss" -->
			<!--and "sub". Thus, both values MUST be used to authenticate the user.-->
		<!--]]>-->
		<!--</Description>-->
		<!--<TestParameters>-->
			<!--<Parameter Key="discovery_support_needed">false</Parameter>-->
			<!--<Parameter Key="dynamic_client_registration_support_needed">false</Parameter>-->
		<!--</TestParameters>-->
		<!--<BrowserSimulator>-->
			<!--<ImplementationClass>de.rub.nds.oidc.browser.DefaultRPTestBrowser</ImplementationClass>-->
			<!--<Parameter Key="use_evil_needle">false</Parameter>-->
		<!--</BrowserSimulator>-->
		<!--<OPConfig-1>-->
			<!--<ImplementationClass>de.rub.nds.oidc.server.op.DefaultOP</ImplementationClass>-->
		<!--</OPConfig-1>-->
		<!--<OPConfig-2>-->
			<!--<ImplementationClass>de.rub.nds.oidc.server.op.DefaultOP</ImplementationClass>-->

			<!--&lt;!&ndash; gets the "sub" configured in the Honest OP" &ndash;&gt;-->
			<!--<Parameter Key="force_honest_idtoken_iss">false</Parameter>-->
			<!--<Parameter Key="force_honest_idtoken_sub">true</Parameter>-->
			<!--<Parameter Key="force_honest_idtoken_name">false</Parameter>-->
			<!--<Parameter Key="force_honest_idtoken_username">false</Parameter>-->
			<!--<Parameter Key="force_honest_idtoken_email">false</Parameter>-->
		<!--</OPConfig-2>-->
	<!--</TestStep>-->

</TestPlan>
